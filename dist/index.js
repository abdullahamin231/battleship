(()=>{"use strict";class e{constructor(e){this.len=e,this.hits=0,this.sunk=!1}hit(){this.hits+=1}isSunk(){return this.hits==this.len}}class t{constructor(){this.board=[];for(let e=0;e<10;e++)for(let t=0;t<10;t++)this.board.push([e,t]);this.ships=[],this.index=0,this.actualShips=[]}showShip(){for(let e=0;e<this.actualShips.length;e++)console.log(this.actualShips[e])}place(e,t,l,s,a){const i=this.index;if(this.actualShips[i]=e,"horizontal"==s)for(let s=l;s<l+e.len;s++)document.querySelector(`${a}[data-x="${t}"][data-y="${s}"]`).classList.add("ship"),this.ships.push([t,s]);else for(let s=t;s<t+e.len;s++)document.querySelector(`${a}[data-x="${s}"][data-y="${l}"]`).classList.add("ship"),this.ships.push([s,l]);this.index+=1}hitted(e,t){for(let l=0;l<this.ships.length;l++)if(this.ships[l][0]==e&&this.ships[l][1]==t)return!0;return!1}recieveAttack(e,t,l){let s=!1;const a=document.querySelector(`${l}[data-x="${e}"][data-y="${t}"]`);a||console.log("Cell not found"),this.hitted(e,t)&&(a.classList.add("hit"),s=!0),console.log(s),s||a.classList.add("miss")}allSunk(){console.log("Checking for winner");for(let e=0;e<this.actualShips.length;e++)if(this.actualShips[e].hits!=this.actualShips[e].len)return!1;return!0}print(){for(let e=0;e<this.board.length;e++)console.log(this.board[e])}}class l{attack(e,t,l){l.recieveAttack(e,t)}move(){return[Math.floor(10*Math.random()),Math.floor(10*Math.random())]}}function s(e,t){const l=document.getElementById(t);for(let e=0;e<10;e++)for(let s=0;s<10;s++){const a=document.createElement("div");a.dataset.x=e,a.dataset.y=s,"ai"==t?a.classList.add("aiCell"):a.classList.add("playerCell"),a.classList.add("cell"),l.appendChild(a)}}new l;const a=new t;s(0,"player"),a.place(new e(5),0,0,"horizontal",".playerCell"),a.place(new e(4),1,0,"horizontal",".playerCell"),a.place(new e(3),2,0,"horizontal",".playerCell"),a.place(new e(2),3,0,"horizontal",".playerCell");const i=new l,o=new t;function n(){if(o.showShip(),a.allSunk())document.getElementById("result").innerHTML="ai won";else if(o.allSunk())document.getElementById("result").innerHTML="player won";else{e=(e,t)=>{o.recieveAttack(e,t,".aiCell")},document.querySelectorAll(".aiCell").forEach((t=>{t.addEventListener("click",(()=>{const l=t.dataset.x,s=t.dataset.y;e(l,s)}))}));const[t,l]=i.move();a.recieveAttack(t,l,".playerCell")}var e}s(0,"ai"),o.place(new e(5),0,0,"horizontal",".aiCell"),o.place(new e(4),1,0,"horizontal",".aiCell"),o.place(new e(3),2,0,"horizontal",".aiCell"),o.place(new e(2),3,0,"horizontal",".aiCell"),console.log(o),console.log(a),document.querySelectorAll(".aiCell").forEach((e=>{e.addEventListener("click",n)}))})();