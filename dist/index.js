(()=>{"use strict";class t{constructor(t){this.len=t,this.hits=0,this.sunk=!1,this.cords=Array(t)}hit(){this.hits+=1}isSunk(){return this.hits==this.len}}class e{constructor(){this.board=[];for(let t=0;t<10;t++)for(let e=0;e<10;e++)this.board.push([t,e]);this.ships=[],this.index=0,this.actualShips=[]}showShips(){for(let t=0;t<this.actualShips.length;t++)console.log(this.actualShips[t])}place(t,e,l,s,a){const i=this.index;if(this.actualShips[i]=t,"horizontal"==s)for(let s=l;s<l+t.len;s++)document.querySelector(`${a}[data-x="${e}"][data-y="${s}"]`).classList.add("ship"),this.ships.push([e,s,i]);else for(let s=e;s<e+t.len;s++)document.querySelector(`${a}[data-x="${s}"][data-y="${l}"]`).classList.add("ship"),this.ships.push([s,l,i]);this.index+=1}hitted(t,e){for(let l=0;l<this.ships.length;l++)if(this.ships[l][0]==t&&this.ships[l][1]==e)return this.actualShips[this.ships[l][2]].hits+=1,!0;return!1}recieveAttack(t,e,l){let s=!1;const a=document.querySelector(`${l}[data-x="${t}"][data-y="${e}"]`);a||console.log("Cell not found"),this.hitted(t,e)&&(a.classList.add("hit"),s=!0),console.log(s),s||a.classList.add("miss")}allSunk(){console.log("Checking for winner");for(let t=0;t<this.actualShips.length;t++)if(this.actualShips[t].hits!=this.actualShips[t].len)return!1;return!0}print(){for(let t=0;t<this.board.length;t++)console.log(this.board[t])}}class l{attack(t,e,l){l.recieveAttack(t,e)}move(){return[Math.floor(10*Math.random()),Math.floor(10*Math.random())]}}function s(t,e){const l=document.getElementById(e);for(let t=0;t<10;t++)for(let s=0;s<10;s++){const a=document.createElement("div");a.dataset.x=t,a.dataset.y=s,"ai"==e?a.classList.add("aiCell"):a.classList.add("playerCell"),a.classList.add("cell"),l.appendChild(a)}}new l;const a=new e;s(0,"player"),a.place(new t(5),0,0,"horizontal",".playerCell"),a.place(new t(4),1,0,"horizontal",".playerCell"),a.place(new t(3),2,0,"horizontal",".playerCell"),a.place(new t(2),3,0,"horizontal",".playerCell");const i=new l,n=new e;function o(){if(n.showShips(),a.allSunk())document.getElementById("result").innerHTML="ai won";else if(n.allSunk())document.getElementById("result").innerHTML="player won";else{t=(t,e)=>{n.recieveAttack(t,e,".aiCell")},document.querySelectorAll(".aiCell").forEach((e=>{e.addEventListener("click",(()=>{const l=e.dataset.x,s=e.dataset.y;t(l,s)}))}));const[e,l]=i.move();a.recieveAttack(e,l,".playerCell")}var t}s(0,"ai"),n.place(new t(5),0,0,"horizontal",".aiCell"),n.place(new t(4),1,0,"horizontal",".aiCell"),n.place(new t(3),2,0,"horizontal",".aiCell"),n.place(new t(2),3,0,"horizontal",".aiCell"),document.querySelectorAll(".aiCell").forEach((t=>{t.addEventListener("click",o)}))})();